function import$(t,n){var i={}.hasOwnProperty;for(var r in n)i.call(n,r)&&(t[r]=n[r]);return t}var auth,x$;auth=function(t,n,i){var r=this;return this.mode=0,this.parent=i,t["tab.signup"].addEventListener("click",function(){return r.tab("signup")}),t["tab.login"].addEventListener("click",function(){return r.tab("login")}),t.action.addEventListener("click",function(){return r.signin(0===r.mode)})},x$=auth,x$.controller="auth",import$(x$.prototype,{tab:function(t){var n,i,r;return n=["signup","login"],i=["註冊","登入"],this.mode=r=n.indexOf(t),this.dom["tab."+n[r]].setAttribute("class","active nav-link"),this.dom["tab."+n[1-r]].setAttribute("class","nav-link"),this.setText("action",i[r]),this.dom.displayname.style.display=r?"none":"block",this.dom.newsletter.style.display=r?"none":"block"},error:function(t,n){return this.setText("error."+t,n),this.dom.model[t].setAttribute("class","form-control is-invalid"),this.running(!1)},running:function(t){return null==t&&(t=!0),this.dom.action.setAttribute("class",t?this.dom.action.getAttribute("class")+" running":this.dom.action.getAttribute("class").replace(/ *running */g," "))},signin:function(t){var n=this;return null==t&&(t=!0),["email","displayname","passwd"].map(function(t){return n.dom.model[t].setAttribute("class","form-control")}),/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.[a-z]{2,}|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i.exec(this.data.email)?t&&!this.data.displayname?this.error("displayname","這個欄位為必填"):this.data.passwd?this.data.passwd.length<4?this.error("passwd","密碼太弱"):(this.running(),$.ajax({url:t?"/u/signup":"/u/login",method:"POST",data:this.data}).done(function(t){return n.parent.fire("authpanel.off"),n.parent.fire("login",t),n.running(!1)}).fail(function(i){return 403===i.status?t?n.error("email","已經註冊過了"):n.error("passwd","密碼不符"):n.error("email","系統問題，請稍候再試")})):this.error("passwd","這個欄位為必填"):this.error("email","這不是電子郵件")}});